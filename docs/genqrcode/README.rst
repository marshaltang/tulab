=======================
二维码入网测试送检指南
=======================

文档编号：ZJJK-3000-16



Step1
~~~~~~~~~~~~~~~

.. Note :: 参考下面数据结构准备IGNP请求文件

.. cssclass:: table-bordered

+-------------------+---------------------+-------------------------------------------+ 
| 字段              |字段功能说明(字节)   | IGNP文件数据结构                          | 
+===================+=====================+===========================================+ 
|  01               |header               |0x23                                       |
+-------------------+---------------------+-------------------------------------------+
|  02               |service code         |0x01010000                                 |                                           
+-------------------+---------------------+-------------------------------------------+
|  03               |format               |0x02                                       |                                           
+-------------------+---------------------+-------------------------------------------+
|  04               |iin                  |0x09981001                                 |                                           
+-------------------+---------------------+-------------------------------------------+
|  05               |Valid date           |                                           |                                           
+-------------------+---------------------+-------------------------------------------+
|  06               |sn                   |                                           |                       
+-------------------+---------------------+-------------------------------------------+
|  07               |sm3 algo             |                                           |                                           
+-------------------+---------------------+-------------------------------------------+
|  08               |sm2 algo             |                                           |                                           
+-------------------+---------------------+-------------------------------------------+
|  09               |ecc para             |                                           |                                           
+-------------------+---------------------+-------------------------------------------+
|  10               |机构公钥长度         |0x21                                       |                                           
+-------------------+---------------------+-------------------------------------------+
|  11               |机构公钥(点压缩)     |                                           |                                           
+-------------------+---------------------+-------------------------------------------+
|  12               |机构私钥签名         |                                           |                                           
+-------------------+---------------------+-------------------------------------------+
	
Step2
~~~~~~~~~~~~~~~

.. Note :: 参考SmartCA  https://gitlab.t-union.com/smartCA/README.html ，签发生成测试发码机构公钥证书


	
Step3
~~~~~~~~~~~~~~~

.. Note :: 使用测试的发码机构公钥证书,参考下面数据结构生成交通部标准测试qrcode

.. cssclass:: table-bordered

+-------------------+---------------------+-------------------------------------------+-------------------------------------------+
| 字段              |字段功能说明(字节)   | 80版本qrcode数据结构                      | 81版本qrcode数据结构（讨论稿）            |
+===================+=====================+===========================================+===========================================+
|  01               |二维码版本号         |                                           |                                           |
+-------------------+---------------------+-------------------------------------------+-------------------------------------------+
|  02               |二维码数据长度       |                                           |                                           |
+-------------------+---------------------+-------------------------------------------+-------------------------------------------+
|  03               |发卡机构公钥证书     | 以本字段的机构代码进行数据交换            |                                           |
+-------------------+---------------------+-------------------------------------------+-------------------------------------------+
|  04               |支付账户号           |                                           |                                           |
+-------------------+---------------------+-------------------------------------------+-------------------------------------------+
|  05               |用户账户号           |                                           |                                           |
+-------------------+---------------------+-------------------------------------------+-------------------------------------------+
|  06               |机构代码             | 此字段为冗余数据                          |拟修改为二维码生成tac                      |
+-------------------+---------------------+-------------------------------------------+-------------------------------------------+
|  07               |平台代码             |                                           |                                           |
+-------------------+---------------------+-------------------------------------------+-------------------------------------------+
|  08               |用户账户类           |                                           |                                           |
+-------------------+---------------------+-------------------------------------------+-------------------------------------------+
|  09               |授权金额上限         |                                           |                                           |
+-------------------+---------------------+-------------------------------------------+-------------------------------------------+
|  10               |支付账户公钥(点压缩) |                                           |                                           |
+-------------------+---------------------+-------------------------------------------+-------------------------------------------+
|  11               |支付账户过期时间     |                                           |                                           |
+-------------------+---------------------+-------------------------------------------+-------------------------------------------+
|  12               |二维码有效时间       |                                           |                                           |
+-------------------+---------------------+-------------------------------------------+-------------------------------------------+
|  13               |自定义域长度         |                                           |                                           |
+-------------------+---------------------+-------------------------------------------+-------------------------------------------+
|  14               |自定义域数据         |                                           |拟增加4b票种代码                           |
+-------------------+---------------------+-------------------------------------------+-------------------------------------------+
|  15               |发码机构授权签名     |                                           |                                           |
+-------------------+---------------------+-------------------------------------------+-------------------------------------------+
|  16               |二维码生成时间       |                                           |                                           |
+-------------------+---------------------+-------------------------------------------+-------------------------------------------+
|  17               |支付账户授权签名     |                                           |                                           |
+-------------------+---------------------+-------------------------------------------+-------------------------------------------+

	

	
Step4
~~~~~~~~~~~~~~~~~~~~~

联系金卡检测实验室,签署委托测试合同,提交入网测试样品(qrcode截图)


	


