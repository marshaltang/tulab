======================
1:1人脸识别验证方案
======================

.. cssclass:: table-bordered

+-----------------------+---------------------+-------------------------------------------+
| 文档编号（含版本信息）|更新日期             | 变更说明                                  |
+=======================+=====================+===========================================+
| ZJJK-3000-xx-2021     |2019年7月1日         |初始版本                                   |
+-----------------------+---------------------+-------------------------------------------+

1:1人脸识别交易流程

.. mermaid::

   sequenceDiagram
    participant 人脸识别设备
    participant PICC
	participant 人脸
	

	
	人脸识别设备-->>PICC :选择PPSE
	
	PICC-->>人脸识别设备:返回FCI数据和SW1SW2
	
	人脸识别设备-->>PICC :选择K1或K6的ADF
	
	PICC-->>人脸识别设备:返回FCI数据和SW1SW2
	
	loop healthcheck
          人脸识别设备-->>人脸识别设备:检查卡片返回tagDF0A是否支持人脸识别验证方案
        end
	
	人脸识别设备-->>PICC :使用READ PICTURE指令读取SFI1B照片文件的头2个字节
	
	PICC-->>人脸识别设备:返回照片文件的总长度和SW1SW2
	
	
	人脸识别设备-->>PICC :使用READ PICTURE指令一次读取SFI1B照片文件
	
	PICC-->>人脸识别设备:返回1B数据和SW1SW2
	
	loop healthcheck
          人脸识别设备-->>人脸识别设备:提取1B文件特征值1
        end
	
	loop healthcheck
          人脸识别设备-->>人脸识别设备:UI或语音提示请刷脸
        end
	
	人脸 -->>人脸识别设备:通过光学设备获取人脸数据

	loop healthcheck
          人脸识别设备-->>人脸识别设备:裁剪形成照片文件并提取特征值2
        end
	
	loop healthcheck
          人脸识别设备-->>人脸识别设备:比对特征值1和特征值2
        end
	
	loop healthcheck
          人脸识别设备-->>人脸识别设备:提示持卡人人脸核验成功
        end
	
	
	






